<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ›‰Â·ç™’ï½œç›´ æ’­ è®€ ç¶“ å…± ä¿®</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  min-height: 100vh;
  background: linear-gradient(135deg, #e5d5c3 0%, #ede5d7 50%, #f0e8d7 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  font-family: "PingFang TC", "Microsoft JhengHei", serif;
  padding: 20px;
  position: relative;
  overflow-y: auto;
}

/* èƒŒæ™¯è“®èŠ±è£é£¾ */
body::before {
  content: "";
  position: fixed;
  font-size: 120px;
  opacity: 0.025;
  top: -20px;
  left: -20px;
  pointer-events: none;
  z-index: 0;
}

body::after {
  content: "";
  position: fixed;
  font-size: 100px;
  opacity: 0.025;
  bottom: -10px;
  right: -10px;
  pointer-events: none;
  z-index: 0;
  transform: rotate(180deg);
}

.container {
  width: 100%;
  max-width: 800px;
  background: rgba(245, 240, 230, 0.75);
  border-radius: 24px;
  padding: 40px;
  box-shadow: 0 8px 32px rgba(140, 110, 85, 0.12);
  border: 2px solid rgba(212, 195, 175, 0.4);
  backdrop-filter: blur(10px);
  position: relative;
  z-index: 1;
}

.header {
  text-align: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 2px solid rgba(180, 140, 110, 0.25);
  position: relative;
}

.lotus-decoration {
  font-size: 28px;
  margin-bottom: 8px;
  filter: drop-shadow(0 2px 4px rgba(180, 130, 95, 0.15));
}

.title {
  font-size: 26px;
  color: #b4825f;
  letter-spacing: 0.3em;
  margin-bottom: 12px;
  font-weight: 600;
  text-shadow: 0 2px 4px rgba(180, 130, 95, 0.08);
}

.hint {
  font-size: 13px;
  color: #8a7564;
  letter-spacing: 0.05em;
}

.edit-btn {
  position: absolute;
  top: 0;
  right: 0;
  width: 36px;
  height: 36px;
  background: rgba(180, 130, 85, 0.12);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  color: #b4825f;
  font-size: 18px;
}

.edit-btn:hover {
  background: rgba(255, 140, 66, 0.15);
  border-color: #e8824a;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(232, 130, 74, 0.2);
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(225, 215, 201, 0.96);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(8px);
}

.modal.show {
  display: flex;
}

.modal-content {
  background: rgba(245, 240, 230, 0.96);
  border-radius: 20px;
  padding: 35px;
  width: 90%;
  max-width: 600px;
  border: 2px solid rgba(180, 140, 110, 0.3);
  box-shadow: 0 12px 40px rgba(140, 110, 85, 0.2);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.modal-title {
  font-size: 20px;
  color: #b4825f;
  letter-spacing: 0.2em;
  font-weight: 600;
}

.close-btn {
  background: none;
  border: none;
  color: #8a7564;
  font-size: 28px;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  border-radius: 6px;
}

.close-btn:hover {
  color: #b4825f;
  background: rgba(180, 130, 85, 0.12);
}

.input-wrapper {
  margin-bottom: 20px;
}

.input-label {
  color: #75644e;
  font-size: 14px;
  margin-bottom: 10px;
  display: block;
  font-weight: 500;
}

input[type="text"] {
  width: 100%;
  background: rgba(240, 235, 220, 0.6);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 10px;
  padding: 12px 16px;
  color: #4a3a2a;
  font-family: inherit;
  font-size: 15px;
  transition: all 0.3s ease;
}

input[type="text"]:focus {
  outline: none;
  border-color: #e8824a;
  background: rgba(240, 235, 220, 0.85);
  box-shadow: 0 0 0 3px rgba(232, 130, 74, 0.1);
}

input[type="text"]::placeholder {
  color: #a89e8f;
}

.upload-area {
  border: 2px dashed rgba(180, 130, 85, 0.35);
  border-radius: 12px;
  padding: 35px;
  text-align: center;
  margin-bottom: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  background: rgba(240, 235, 220, 0.5);
}

.upload-area:hover {
  border-color: #e8824a;
  background: rgba(232, 130, 74, 0.1);
  transform: translateY(-2px);
}

.upload-icon {
  font-size: 48px;
  margin-bottom: 12px;
}

.upload-text {
  color: #75644e;
  font-size: 15px;
  margin-bottom: 6px;
  font-weight: 500;
}

.upload-hint {
  color: #8a7564;
  font-size: 13px;
}

.divider {
  text-align: center;
  color: #8a7564;
  margin: 20px 0;
  font-size: 13px;
  letter-spacing: 0.1em;
}

.textarea-wrapper {
  margin-bottom: 24px;
}

.textarea-label {
  color: #75644e;
  font-size: 14px;
  margin-bottom: 10px;
  display: block;
  font-weight: 500;
}

textarea {
  width: 100%;
  height: 200px;
  background: rgba(240, 235, 220, 0.6);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 10px;
  padding: 16px;
  color: #4a3a2a;
  font-family: inherit;
  font-size: 15px;
  line-height: 1.8;
  resize: vertical;
  transition: all 0.3s ease;
}

textarea:focus {
  outline: none;
  border-color: #e8824a;
  background: rgba(240, 235, 220, 0.85);
  box-shadow: 0 0 0 3px rgba(232, 130, 74, 0.1);
}

textarea::placeholder {
  color: #a89e8f;
}

.btn-group {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.btn {
  padding: 12px 28px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-size: 15px;
  transition: all 0.3s ease;
  font-family: inherit;
  font-weight: 500;
  letter-spacing: 0.05em;
}

.btn-primary {
  background: linear-gradient(135deg, #e8824a, #f0a060);
  color: white;
  box-shadow: 0 4px 12px rgba(232, 130, 74, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(232, 130, 74, 0.4);
}

.btn-secondary {
  background: rgba(180, 130, 85, 0.12);
  color: #75644e;
  border: 2px solid rgba(180, 130, 85, 0.25);
}

.btn-secondary:hover {
  background: rgba(180, 130, 85, 0.18);
  border-color: rgba(180, 130, 85, 0.35);
}

.reader {
  position: relative;
  height: 400px;
  overflow: hidden;
  border-radius: 16px;
  background: linear-gradient(to bottom, rgba(190, 210, 195, 0.18), rgba(240, 235, 220, 0.35));
  padding: 20px;
  border: 2px solid rgba(190, 210, 195, 0.35);
}

.lines {
  position: relative;
  height: 100%;
  overflow-y: auto;
  padding: 180px 0;
  scroll-behavior: smooth;
}

.lines::-webkit-scrollbar {
  width: 8px;
}

.lines::-webkit-scrollbar-track {
  background: rgba(180, 130, 85, 0.08);
  border-radius: 4px;
}

.lines::-webkit-scrollbar-thumb {
  background: rgba(180, 130, 85, 0.35);
  border-radius: 4px;
}

.lines::-webkit-scrollbar-thumb:hover {
  background: rgba(180, 130, 85, 0.5);
}

.line {
  display: grid;
  place-items: center;
  text-align: center;
  height: 55px;
  padding: 0 24px;
  font-size: 18px;
  letter-spacing: 0.25em;
  color: rgba(117, 100, 78, 0.2);
  transition: all 0.4s ease;
  cursor: pointer;
}

.line.active {
  color: #4a3a2a;
  font-size: 32px;
  text-shadow: 0 2px 10px rgba(232, 130, 74, 0.25);
  font-weight: 500;
  height: 100px;
}

.line.near {
  color: rgba(74, 58, 42, 0.7);
  font-size: 24px;
  height: 75px;
}

.footer {
  margin-top: 30px;
  padding-top: 20px;
  border-top: 2px solid rgba(180, 140, 110, 0.25);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  color: #8a7564;
}

.progress {
  display: flex;
  align-items: center;
  gap: 12px;
  letter-spacing: 0.05em;
}

.progress-bar {
  width: 120px;
  height: 6px;
  background: rgba(180, 130, 85, 0.2);
  border-radius: 3px;
  overflow: hidden;
  border: 1px solid rgba(180, 130, 85, 0.25);
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #e8824a, #f0a060);
  transition: width 0.3s ease;
  box-shadow: 0 0 8px rgba(232, 130, 74, 0.4);
}

kbd {
  padding: 3px 8px;
  background: rgba(180, 130, 85, 0.15);
  border: 1px solid rgba(180, 130, 85, 0.3);
  border-radius: 4px;
  font-size: 12px;
  margin: 0 3px;
  color: #75644e;
  font-weight: 500;
}

#fileInput {
  display: none;
}

@media (max-width: 600px) {
  .container {
    padding: 28px;
  }

  .title {
    font-size: 22px;
  }

  .reader {
    height: 350px;
  }

  .line {
    font-size: 16px;
    height: 50px;
  }

  .line.active {
    font-size: 28px;
    height: 90px;
  }

  .line.near {
    font-size: 22px;
    height: 70px;
  }
}

/* æ”åƒé ­å€åŸŸæ¨£å¼ */
.camera-container {
  width: 100%;
  max-width: 800px;
  background: rgba(245, 240, 230, 0.75);
  border-radius: 20px;
  padding: 15px;
  box-shadow: 0 6px 24px rgba(140, 110, 85, 0.1);
  border: 2px solid rgba(212, 195, 175, 0.4);
  backdrop-filter: blur(10px);
  position: relative;
  z-index: 1;
  margin-bottom: 20px;
  transition: all 0.5s ease;
}

.camera-container.collapsed {
  background: rgba(245, 240, 230, 0.2);
  border-color: rgba(212, 195, 175, 0.15);
  box-shadow: none;
  backdrop-filter: blur(2px);
  padding: 10px;
}

.camera-container.collapsed .camera-title {
  opacity: 0.6;
}

.camera-header {
  text-align: center;
  margin-bottom: 8px;
  padding-bottom: 6px;
  border-bottom: 2px solid rgba(180, 140, 110, 0.25);
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  transition: border-color 0.5s ease;
}

.camera-container.collapsed .camera-header {
  border-bottom-color: rgba(180, 140, 110, 0.1);
  margin-bottom: 0;
  padding-bottom: 0;
}

.camera-title {
  font-size: 16px;
  color: #b4825f;
  letter-spacing: 0.2em;
  font-weight: 600;
  transition: opacity 0.5s ease;
}

.toggle-camera-btn {
  position: absolute;
  right: 0;
  width: 28px;
  height: 28px;
  background: rgba(180, 130, 85, 0.12);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  color: #b4825f;
  font-size: 14px;
}

.toggle-camera-btn:hover {
  background: rgba(255, 140, 66, 0.15);
  border-color: #e8824a;
  transform: scale(1.05);
}

.camera-content {
  overflow: hidden;
  transition: all 0.5s ease;
}

.camera-content.hidden {
  max-height: 0;
  opacity: 0;
  margin: 0;
}

.camera-content.visible {
  max-height: 500px;
  opacity: 1;
}

.camera-controls {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 10px;
}

.camera-btn {
  padding: 6px 16px;
  background: rgba(180, 130, 85, 0.12);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 8px;
  color: #b4825f;
  cursor: pointer;
  font-size: 13px;
  letter-spacing: 0.1em;
  transition: all 0.3s ease;
}

.camera-btn:hover {
  background: rgba(255, 140, 66, 0.15);
  border-color: #e8824a;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(232, 130, 74, 0.2);
}

.camera-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}





.camera-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 200px;
  color: #8a7564;
  font-size: 14px;
  letter-spacing: 0.1em;
}

/* å°å’Œå°šåœ–ç‰‡åŠŸèƒ½ */
.monk-upload-container {
  width: 100%;
  max-width: 800px;
  background: rgba(245, 240, 230, 0.75);
  border-radius: 20px;
  padding: 15px;
  box-shadow: 0 6px 24px rgba(140, 110, 85, 0.1);
  border: 2px solid rgba(212, 195, 175, 0.4);
  backdrop-filter: blur(10px);
  position: relative;
  z-index: 1;
  margin-top: 20px;
  text-align: center;
}

.monk-upload-title {
  font-size: 16px;
  color: #b4825f;
  letter-spacing: 0.2em;
  font-weight: 600;
  margin-bottom: 10px;
}

.monk-upload-btn {
  padding: 8px 20px;
  background: rgba(180, 130, 85, 0.12);
  border: 2px solid rgba(180, 130, 85, 0.25);
  border-radius: 10px;
  color: #b4825f;
  cursor: pointer;
  font-size: 13px;
  letter-spacing: 0.1em;
  transition: all 0.3s ease;
}

.monk-upload-btn:hover {
  background: rgba(255, 140, 66, 0.15);
  border-color: #e8824a;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(232, 130, 74, 0.2);
}

#monkFileInput {
  display: none;
}

.monk-status {
  margin-top: 8px;
  font-size: 12px;
  color: #8a7564;
}

/* åº•éƒ¨å’Œå°šå‹•ç•«å€åŸŸ */
.monk-animation-area {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 150px;
  pointer-events: none;
  z-index: 999;
  overflow: hidden;
}

.floating-monk {
  position: absolute;
  bottom: 0;
  max-height: 120px;
  width: auto;
  opacity: 0;
  transition: opacity 1s ease-in-out;
  pointer-events: none;
}

.floating-monk.visible {
  opacity: 1;
}

.floating-monk.fade-out {
  opacity: 0;
}


/* å®£å‚³æ¡†æ¨£å¼ */








.promo-link:hover {
  color: #8a6644;
  text-shadow: 0 2px 8px rgba(180, 130, 95, 0.2);
}





/* Logo åœ–ç‰‡æ¨£å¼ */




.upload-buttons-row {
  display: flex;
  gap: 12px;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
}

#logoFileInput {
  display: none;
}


        /* æ”åƒé ­é«˜åº¦æ§åˆ¶ */
        .camera-height-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 8px 12px;
            background: rgba(240, 235, 220, 0.5);
            border-radius: 8px;
        }

        .camera-height-label {
            color: #75644e;
            font-size: 13px;
            font-weight: 500;
            letter-spacing: 0.05em;
            min-width: 80px;
        }

        .camera-height-slider {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(180, 130, 85, 0.2);
            border-radius: 3px;
            outline: none;
            border: 1px solid rgba(180, 130, 85, 0.25);
        }

        .camera-height-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #e8824a, #f0a060);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(232, 130, 74, 0.3);
        }

        .camera-height-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #e8824a, #f0a060);
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 2px 6px rgba(232, 130, 74, 0.3);
        }

        .camera-height-value {
            color: #b4825f;
            font-size: 13px;
            font-weight: 600;
            min-width: 50px;
            text-align: right;
        }

        /* å¯æ‹–å‹•çš„æ”åƒé ­å€åŸŸ */
        .video-wrapper {
            position: relative;
            width: 100%;
            background: rgba(220, 210, 195, 0.3);
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid rgba(180, 140, 110, 0.2);
            min-height: 150px;
            max-height: 600px;
            height: 300px;
        }

        .resize-handle {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 12px;
            background: linear-gradient(to top, rgba(180, 130, 85, 0.3), transparent);
            cursor: ns-resize;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: background 0.3s ease;
        }

        .resize-handle:hover {
            background: linear-gradient(to top, rgba(232, 130, 74, 0.5), rgba(232, 130, 74, 0.1));
        }

        .resize-handle::before {
            content: 'â‹®';
            color: rgba(180, 130, 85, 0.6);
            font-size: 18px;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .resize-handle:hover::before {
            color: rgba(232, 130, 74, 0.9);
        }

        #cameraVideo {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
        }

        /* æ©«å‘å®£å‚³å€åŸŸå¸ƒå±€ */
        .promo-box {
            width: 100%;
            max-width: 800px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(245, 235, 220, 0.6));
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 6px 24px rgba(140, 110, 85, 0.1);
            border: 2px solid rgba(212, 195, 175, 0.4);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 1;
            margin-bottom: 20px;
        }

        .promo-content {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 20px;
        }

        .promo-logo-section {
            flex-shrink: 0;
        }

        .promo-text-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            text-align: left;
        }

        .promo-logo-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            filter: drop-shadow(0 2px 4px rgba(180, 130, 95, 0.15));
            border: 2px solid rgba(180, 140, 110, 0.2);
        }

        .promo-logo-placeholder {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(240, 235, 220, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            filter: drop-shadow(0 2px 4px rgba(180, 130, 95, 0.15));
            border: 2px solid rgba(180, 140, 110, 0.2);
        }

        .promo-handle {
            font-size: 16px;
            color: #8a7564;
            letter-spacing: 0.02em;
        }

        .promo-link {
            font-size: 18px;
            font-weight: 600;
            color: #b4825f;
            text-decoration: none;
            letter-spacing: 0.05em;
            transition: all 0.3s ease;
        }

        .promo-link:hover {
            color: #8a6644;
            text-shadow: 0 2px 8px rgba(180, 130, 95, 0.2);
        }

        .promo-text {
            font-size: 16px;
            color: #8a7564;
            letter-spacing: 0.05em;
            line-height: 1.6;
        }

        .promo-time {
            font-size: 14px;
            color: #9a8574;
            letter-spacing: 0.02em;
            font-family: 'Times New Roman', serif;
        }

        @media (max-width: 600px) {
            .promo-content {
                flex-direction: column;
                text-align: center;
            }

            .promo-text-section {
                align-items: center;
                text-align: center;
            }
        }

    </style>
</head>
<body>

<div class="camera-container" id="cameraContainer">
  <div class="camera-header">
    <div class="camera-title"> ç›´æ’­ä¸­ ğŸ”´ LIVE  </div>
    <button class="toggle-camera-btn" onclick="toggleCameraSection()" title="é¡¯ç¤º/éš±è—">
      <span id="toggleIcon">â–¼</span>
    </button>
  </div>

  <div class="camera-content visible" id="cameraContent">
    <div class="camera-controls">
      <button class="camera-btn" id="startCameraBtn" onclick="startCamera()">é–‹å•Ÿæ”åƒé ­</button>
      <button class="camera-btn" id="stopCameraBtn" onclick="stopCamera()" disabled>é—œé–‰æ”åƒé ­</button>
            <button class="camera-btn" id="switchCameraBtn" onclick="switchCamera()" disabled>åˆ‡æ›é¡é ­ ğŸ“·</button>
    </div>

    <div class="video-wrapper">
      <video id="cameraVideo" autoplay playsinline style="display: none;"></video>
      <div class="camera-placeholder" id="cameraPlaceholder">é»æ“Šã€Œé–‹å•Ÿæ”åƒé ­ã€é–‹å§‹ä½¿ç”¨</div>
    </div>
  </div>
</div>


<!-- å®£å‚³æ¡† -->
<div class="promo-box">
  <div class="promo-content">
    <div class="promo-logo" id="promoLogoContainer">
      <div class="promo-logo-placeholder" id="promoLogoPlaceholder">ğŸª·</div>
      <img id="promoLogoImg" class="promo-logo-img" style="display: none;">
    </div>
    <a href="https://www.instagram.com/bloomie_hk/#" target="_blank" class="promo-link">@bloomie_hk</a>
    <div class="promo-text">æ›‰Â·ç™’ï½œè®€ç¶“å…±ä¿®</div>
    <div class="promo-time">ğŒğ¨ğ§ - ğ…ğ«ğ¢ ğŸ•ğšğ¦ - ğŸ–ğšğ¦ / ğ’ğšğ­ ğŸ—ğšğ¦ - ğŸğŸğšğ¦</div>
  </div>
</div>

<div class="container">
<div class="header">
    <div class="lotus-decoration" style="display:none;"></div>
    <div class="title" id="mainTitle">ç¶“æ–‡é–±è®€å™¨</div>
   <!--<div class="hint">ä½¿ç”¨ <kbd>â†‘</kbd> <kbd>â†“</kbd> æˆ–æ»‘é¼ æ»¾è¼ªé–±è®€</div>--> 
    <div class="edit-btn" onclick="openModal()" title="è¼‰å…¥ç¶“æ–‡">â‹¯</div>
  </div>

  <div class="reader">
    <div class="lines" id="lines"></div>
  </div>

  <div class="footer">
    <div class="progress">
      <span>é€²åº¦</span>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>
    <div id="counter">0 / 0</div>
  </div>
</div>

<div class="monk-upload-container">
  <div class="monk-upload-title">åœ–ç‰‡ä¸Šå‚³</div>
  <div class="upload-buttons-row">
    <button class="monk-upload-btn" onclick="document.getElementById('logoFileInput').click()">
      ä¸Šå‚³Logoåœ–ç‰‡
    </button>
    <button class="monk-upload-btn" onclick="document.getElementById('monkFileInput').click()">
      ä¸Šå‚³å°å’Œå°šåœ–ç‰‡ï¼ˆæœ€å¤š5å¼µï¼‰
    </button>
  </div>
  <input type="file" id="logoFileInput" accept="image/*" onchange="handleLogoUpload(event)">
  <input type="file" id="monkFileInput" accept="image/*" multiple onchange="handleMonkUpload(event)">
  <div class="monk-status" id="logoStatus">å°šæœªä¸Šå‚³Logo</div>
  <div class="monk-status" id="monkStatus">å°šæœªä¸Šå‚³å°å’Œå°šåœ–ç‰‡</div>
</div>

<!-- åº•éƒ¨å’Œå°šå‹•ç•«å€åŸŸ -->
<div class="monk-animation-area" id="monkAnimationArea"></div>

<div class="modal"
 id="modal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title">è¼‰å…¥ç¶“æ–‡</div>
      <button class="close-btn" onclick="closeModal()">Ã—</button>
    </div>

    <div class="input-wrapper">
      <label class="input-label">ç¶“æ–‡æ¨™é¡Œï¼ˆé¸å¡«ï¼‰</label>
      <input type="text" id="titleInput" placeholder="ä¾‹å¦‚ï¼šå¿ƒç¶“ã€é‡‘å‰›ç¶“ã€å…­ç¥–å£‡ç¶“...">
    </div>

    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
      <div class="upload-icon">ğŸ“œ</div>
      <div class="upload-text">é»æ“Šä¸Šå‚³ TXT æª”æ¡ˆ</div>
      <div class="upload-hint">æˆ–å°‡æª”æ¡ˆæ‹–æ›³è‡³æ­¤</div>
    </div>
    <input type="file" id="fileInput" accept=".txt" onchange="handleFile(event)">

    <div class="divider">æˆ–</div>

    <div class="textarea-wrapper">
      <label class="textarea-label">ç›´æ¥è²¼ä¸Šç¶“æ–‡ï¼ˆæ¯å¥ä¸€è¡Œï¼‰</label>
      <textarea id="textInput" placeholder="é¡˜æˆ‘æ­¤èº«å¸¸æ¸…æ·¨&#10;å¿ƒå¦‚æ˜é¡ç…§è¬æ–¹&#10;ä¸€å¿µä¸ç”Ÿå…¨é«”ç¾&#10;å…­æ ¹å¿½å‹•è¢«é›²é®"></textarea>
    </div>

    <div class="btn-group">
      <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
      <button class="btn btn-primary" onclick="loadText()">è¼‰å…¥</button>
    </div>
  </div>
</div>

<script>
// é è¨­ç¶“æ–‡
let sutraText = `é¡˜æˆ‘æ­¤èº«å¸¸æ¸…æ·¨
å¿ƒå¦‚æ˜é¡ç…§è¬æ–¹
ä¸€å¿µä¸ç”Ÿå…¨é«”ç¾
å…­æ ¹å¿½å‹•è¢«é›²é®
è‹¥äººè­˜å¾—è‡ªæœ¬å¿ƒ
å¤§åœ°å±±æ²³çš†é“å ´
éœè½é¢¨è²å³æ³•éŸ³
ç´°è§€ä¸€èŠ±ä¸€ä¸–ç•Œ`;

let sutraTitle = '';

const linesContainer = document.getElementById('lines');
const progressFill = document.getElementById('progressFill');
const counter = document.getElementById('counter');
const modal = document.getElementById('modal');
const textInput = document.getElementById('textInput');
const titleInput = document.getElementById('titleInput');
const mainTitle = document.getElementById('mainTitle');
const uploadArea = document.querySelector('.upload-area');

let lineElements = [];
let currentIndex = 0;

// åˆå§‹åŒ–è¼‰å…¥
renderSutra();

function openModal() {
  modal.classList.add('show');
  textInput.value = sutraText;
  titleInput.value = sutraTitle;
  titleInput.focus();
}

function closeModal() {
  modal.classList.remove('show');
}

function handleFile(event) {
  const file = event.target.files[0];
  if (file && file.type === 'text/plain') {
    const reader = new FileReader();
    reader.onload = function(e) {
      textInput.value = e.target.result;
    };
    reader.readAsText(file, 'UTF-8');
  }
}

// æ‹–æ›³ä¸Šå‚³
uploadArea.addEventListener('dragover', (e) => {
  e.preventDefault();
  uploadArea.style.borderColor = '#e8824a';
  uploadArea.style.background = 'rgba(232, 130, 74, 0.12)';
});

uploadArea.addEventListener('dragleave', () => {
  uploadArea.style.borderColor = 'rgba(180, 130, 85, 0.35)';
  uploadArea.style.background = 'rgba(240, 235, 220, 0.5)';
});

uploadArea.addEventListener('drop', (e) => {
  e.preventDefault();
  uploadArea.style.borderColor = 'rgba(180, 130, 85, 0.35)';
  uploadArea.style.background = 'rgba(240, 235, 220, 0.5)';

  const file = e.dataTransfer.files[0];
  if (file && file.type === 'text/plain') {
    const reader = new FileReader();
    reader.onload = function(e) {
      textInput.value = e.target.result;
    };
    reader.readAsText(file, 'UTF-8');
  }
});

function loadText() {
  const text = textInput.value.trim();
  const title = titleInput.value.trim();

  if (text) {
    sutraText = text;
    sutraTitle = title;

    // æ›´æ–°æ¨™é¡Œ
    if (title) {
      mainTitle.textContent = title;
    } else {
      mainTitle.textContent = 'ç¶“æ–‡é–±è®€å™¨';
    }

    renderSutra();
    closeModal();
  }
}

function renderSutra() {
  linesContainer.innerHTML = '';
  const lines = sutraText.split('\n').map(l => l.trim()).filter(l => l);

  lines.forEach((text, index) => {
    const div = document.createElement('div');
    div.className = 'line';
    div.textContent = text;
    div.onclick = () => scrollToLine(index);
    linesContainer.appendChild(div);
  });

  lineElements = Array.from(linesContainer.querySelectorAll('.line'));

  setTimeout(() => {
    scrollToLine(0);
  }, 100);
}

function updateFocus() {
  const containerRect = linesContainer.getBoundingClientRect();
  const centerY = containerRect.top + containerRect.height / 2;

  let closestIndex = 0;
  let minDistance = Infinity;

  lineElements.forEach((line, index) => {
    const rect = line.getBoundingClientRect();
    const lineCenter = rect.top + rect.height / 2;
    const distance = Math.abs(lineCenter - centerY);

    if (distance < minDistance) {
      minDistance = distance;
      closestIndex = index;
    }
  });

  currentIndex = closestIndex;
  updateStyles();
}

function updateStyles() {
  lineElements.forEach((line, index) => {
    line.classList.remove('active', 'near');

    const diff = Math.abs(index - currentIndex);
    if (diff === 0) {
      line.classList.add('active');
    } else if (diff === 1) {
      line.classList.add('near');
    }
  });

  const progress = lineElements.length > 1 ? (currentIndex / (lineElements.length - 1)) * 100 : 0;
  progressFill.style.width = progress + '%';
  counter.textContent = `${currentIndex + 1} / ${lineElements.length}`;
}

function scrollToLine(index) {
  if (index < 0 || index >= lineElements.length) return;

  const line = lineElements[index];
  const containerRect = linesContainer.getBoundingClientRect();
  const lineRect = line.getBoundingClientRect();

  const scrollTop = linesContainer.scrollTop;
  const offset = (lineRect.top + lineRect.height / 2) - (containerRect.top + containerRect.height / 2);

  linesContainer.scrollTo({
    top: scrollTop + offset,
    behavior: 'smooth'
  });
}

linesContainer.addEventListener('scroll', updateFocus);

document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowDown') {
    e.preventDefault();
    scrollToLine(currentIndex + 1);
  } else if (e.key === 'ArrowUp') {
    e.preventDefault();
    scrollToLine(currentIndex - 1);
  } else if (e.key === 'Escape' && modal.classList.contains('show')) {
    closeModal();
  }
});

// é»æ“ŠmodalèƒŒæ™¯é—œé–‰
modal.addEventListener('click', (e) => {
  if (e.target === modal) {
    closeModal();
  }
});


// æ”åƒé ­åŠŸèƒ½
let cameraStream = null;
const cameraVideo = document.getElementById('cameraVideo');
const cameraPlaceholder = document.getElementById('cameraPlaceholder');
const startCameraBtn = document.getElementById('startCameraBtn');
const stopCameraBtn = document.getElementById('stopCameraBtn');

async function startCamera() {
  try {
    cameraStream = await navigator.mediaDevices.getUserMedia({ 
      video: { 
        facingMode: currentFacingMode,
        width: { ideal: 1280 },
        height: { ideal: 720 }
      } 
    });

    cameraVideo.srcObject = cameraStream;
    cameraVideo.style.display = 'block';
    cameraPlaceholder.style.display = 'none';

    startCameraBtn.disabled = true;
    stopCameraBtn.disabled = false;
  } catch (error) {
    console.error('ç„¡æ³•è¨ªå•æ”åƒé ­:', error);
    alert('ç„¡æ³•é–‹å•Ÿæ”åƒé ­ã€‚è«‹ç¢ºä¿å·²æˆäºˆæ”åƒé ­æ¬Šé™ã€‚');
  }
}

function stopCamera() {
  if (cameraStream) {
    cameraStream.getTracks().forEach(track => track.stop());
    cameraStream = null;
    cameraVideo.srcObject = null;
    cameraVideo.style.display = 'none';
    cameraPlaceholder.style.display = 'flex';

    startCameraBtn.disabled = false;
    stopCameraBtn.disabled = true;
  }

    async function switchCamera() {
        // åˆ‡æ›é¡é ­æ¨¡å¼
        currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';

        // åœæ­¢ç•¶å‰ä¸²æµ
        if (cameraStream) {
            cameraStream.getTracks().forEach(track => track.stop());
        }

        // ä½¿ç”¨æ–°çš„é¡é ­æ¨¡å¼é‡æ–°å•Ÿå‹•
        try {
            cameraStream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: currentFacingMode,
                    width: { ideal: 1280 },
                    height: { ideal: 720 }
                }
            });
            cameraVideo.srcObject = cameraStream;
        } catch (error) {
            console.error('åˆ‡æ›é¡é ­å¤±æ•—:', error);
            alert('ç„¡æ³•åˆ‡æ›é¡é ­ï¼Œè«‹ç¢ºèªè¨­å‚™æ”¯æ´æ­¤åŠŸèƒ½');
            // å¦‚æœå¤±æ•—ï¼Œå˜—è©¦åˆ‡æ›å›åŸä¾†çš„æ¨¡å¼
            currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
        }
    }
}

function toggleCameraSection() {
  const cameraContainer = document.getElementById('cameraContainer');
  const cameraContent = document.getElementById('cameraContent');
  const toggleIcon = document.getElementById('toggleIcon');

  if (cameraContent.classList.contains('visible')) {
    cameraContent.classList.remove('visible');
    cameraContent.classList.add('hidden');
    cameraContainer.classList.add('collapsed');
    toggleIcon.textContent = 'â–¶';
  } else {
    cameraContent.classList.remove('hidden');
    cameraContent.classList.add('visible');
    cameraContainer.classList.remove('collapsed');
    toggleIcon.textContent = 'â–¼';
  }
}


// Logo åœ–ç‰‡ä¸Šå‚³è™•ç†
function handleLogoUpload(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    const logoImg = document.getElementById('promoLogoImg');
    const logoPlaceholder = document.getElementById('promoLogoPlaceholder');

    logoImg.src = e.target.result;
    logoImg.style.display = 'block';
    logoPlaceholder.style.display = 'none';

    document.getElementById('logoStatus').textContent = 'å·²ä¸Šå‚³Logoåœ–ç‰‡';
  };

  reader.readAsDataURL(file);
}

// å°å’Œå°šåœ–ç‰‡ç®¡ç†
let monkImages = [];

function handleMonkUpload(event) {
  const files = event.target.files;
  if (files.length === 0) return;

  const maxFiles = Math.min(files.length, 5);
  monkImages = [];
  let loadedCount = 0;

  for (let i = 0; i < maxFiles; i++) {
    const file = files[i];
    const reader = new FileReader();

    reader.onload = function(e) {
      monkImages.push(e.target.result);
      loadedCount++;

      if (loadedCount === maxFiles) {
        document.getElementById('monkStatus').textContent = `å·²ä¸Šå‚³ ${monkImages.length} å¼µå°å’Œå°šåœ–ç‰‡`;
        startMonkAnimation();
      }
    };

    reader.readAsDataURL(file);
  }
}

function startMonkAnimation() {
  function scheduleNextMonk() {
    const delay = Math.random() * 3000 + 2000;
    setTimeout(() => {
      if (monkImages.length > 0) {
        spawnRandomMonk();
        scheduleNextMonk();
      }
    }, delay);
  }

  scheduleNextMonk();
}

function spawnRandomMonk() {
  if (monkImages.length === 0) return;

  const animationArea = document.getElementById('monkAnimationArea');

  // éš¨æ©Ÿæ±ºå®šåŒæ™‚å‡ºç¾æ•¸é‡ï¼š1, 2, æˆ– 3
  const monkCount = Math.floor(Math.random() * 3) + 1;

  for (let i = 0; i < monkCount; i++) {
    const randomIndex = Math.floor(Math.random() * monkImages.length);
    const monkImg = document.createElement('img');
    monkImg.src = monkImages[randomIndex];
    monkImg.className = 'floating-monk';

    const randomLeft = Math.random() * 90;
    monkImg.style.left = randomLeft + '%';

    const randomSize = 80 + Math.random() * 40;
    monkImg.style.maxHeight = randomSize + 'px';

    // éš¨æ©Ÿé€Ÿåº¦ï¼šå¿«(1.5s)ã€ä¸­(3s)ã€æ…¢(5s)
    const speeds = [1.5, 3, 5];
    const randomSpeed = speeds[Math.floor(Math.random() * speeds.length)];
    monkImg.style.transition = `opacity ${randomSpeed}s ease-in-out`;

    animationArea.appendChild(monkImg);

    setTimeout(() => {
      monkImg.classList.add('visible');
    }, 100);

    // é¡¯ç¤ºæ™‚é–“ä¹Ÿæ ¹æ“šé€Ÿåº¦èª¿æ•´
    const displayTime = randomSpeed * 1000 + Math.random() * 2000 + 1000;
    setTimeout(() => {
      monkImg.classList.add('fade-out');
      setTimeout(() => {
        if (monkImg.parentNode) {
          monkImg.parentNode.removeChild(monkImg);
        }
      }, randomSpeed * 1000);
    }, displayTime);
  }
}

</script>

</body>
</html>
